\documentclass{article}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{physics}
\usepackage{amssymb}
\usepackage{booktabs} % For formal tables
\usepackage{graphicx}
\usepackage{empheq}
\usepackage{algorithm2e}
\usepackage{listings} % Required for insertion of code
\usepackage{xcolor} % Required for custom colors

% Define custom colors
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

% Setup the style for code listings
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

% Activate the style
\lstset{style=mystyle}



\begin{document}
\emph{I received an extension from Prof. Porter for 2 days}
\section*{PROBLEMS:}

\subsection*{Problem 5}
Now let's confront our estimates in problem 4 (problem set 1) with experiment.

\subsubsection*{(a) Question}
Make a simple table comparing your variational bounds with the observed ground state energies for lithium, beryllium, and nitrogen. Note that a simple web search for ``ionization potentials'' will get you a multitude of tables of observed values, or you can look at a reference such as the CRC Press's \textit{Handbook of Chemistry and Physics}. The table entries are typically of the form:
\begin{equation*}
    B(Z, N) - B(Z, N - 1).
\end{equation*}

\subsubsection*{(a) Answer}
\begin{table}[h!]
\centering
\begin{tabular}{lccc}
\toprule
Element & Variational Bound (eV) & Observed Energy (eV) & Difference (eV) \\
\midrule
Lithium    & 33.6813 & 5.3917 & 28.2896 \\
Beryllium  & 45.4749 & 9.3227 & 36.1522 \\
Nitrogen   & 87.868 & 14.5341 & 73.3339 \\
\bottomrule
\end{tabular}
\caption{Comparison of Variational Bounds with Observed Ground State Energies}
\label{tab:comparison}
\end{table}

% Inline Python code in the document
\begin{lstlisting}[language=Python]
# calculation for 5 (eV)
rydberg = 13.6 # eV
# make a dictionary that contains the atomic number and number of electrons for li, be, and n
numbers = {'li': [3, 3], 'be': [4, 4], 'n': [7, 7]}
# my variational formula
def variational_formula(Z, n):
    value = n * (Z - (5/16)*(n-1))**2
    return value * rydberg
# loop over the dictionary
for key in numbers:
    # get the values
    Z = numbers[key][0]
    n = numbers[key][1]
    full = variational_formula(Z, n)
    ion = variational_formula(Z, n-1)
    # front the differences
    difference = full - ion
    # print the resultst
    print('For {}:'.format(key))
    print('The full energy is {} eV'.format(full))
    print('The ion energy is {} eV'.format(ion))
    print('The difference is {} eV'.format(difference))
\end{lstlisting}

\subsubsection*{(b) Question}
Do your results make sense? If not, can you figure out what is wrong, and whether the calculation we did for He is to be trusted?

\subsubsection*{(b) Answer}
My results don't make sense, they are way too large consistently. However, my calculation for He is to be trusted, as I obtained a variational bound for one spatial orbital. Since you can have He's two electrons of opposite spin in the same spatial orbital, this doesn't violate the Pauli exclusion principle. However, for the other elements with more electrons, you are fitting more than two electrons into the same spatial orbital, and this is not allowed by the Pauli exclusion principle, so the variational bound is not valid.

\subsection*{Problem 6}
When we discussed the WKB method, we used the fact that if the potential was a constant, the phase of the wave function depended on \( x \) according to \( p(x) = \sqrt{2m(E-V)}\; \text{if}\; \phi(x = 0) = 0 \). Allowing the potential to slowly vary with \( x \), we computed the change in phase from \( x = x_0 \) to \( x \) as
\begin{equation}
    \phi(x) = \int_{x_0}^{x} \sqrt{2m(E-V)}\,dx.
\end{equation}

Thus, if the potential is slowly varying (such that the main variation of the wave function is due to the phase variation), we can write the wave function at \( x \) in terms of the wave function at \( x_0 \) approximately by
\begin{equation}
    \psi(x) \approx \psi(x_0) \exp \left\{ i \int_{x_0}^{x} \sqrt{2m(E-V(x'))}\,dx' \right\}.
\end{equation}

The WKB approximation may be used to estimate tunneling rates through a barrier. That is, there may be a region of potential greater than the energy between two regions where the potential is smaller than the energy. If the particle is in one of the ``allowed'' regions, it cannot classically penetrate the barrier, but it can according to quantum mechanics. Let us consider an example.



% The figure will be included here in the LaTeX document
% Replace 'figure.png' with the actual file name of the figure
\begin{figure}[h!]
    \centering
    \includegraphics[width=0.6\textwidth]{figure.png}
    \caption{Potential \( V(x) \) as a function of \( x \) with labels for \( V_{pk} \), \( E \), and \( x_0 \).}
\end{figure}

We use the WKB method to estimate the tunneling rate as follows: We imagine the \( \alpha \) particle is bound in the nucleus, between \( x = 0 \) and \( x = x_0 \). Sometimes it bounces up against the potential barrier at \( x = x_0 \). When this occurs, there is some probability that it will escape the nucleus, where this probability is just \( |\psi(x_e)/\psi(x_0)|^2 \), where the wave function is estimated according to the WKB method in Eq. 2.

In the classically forbidden region between \( x = x_0 \) and \( x = x_e \), the ``phase'' is imaginary, and the exponential factor damps the wave function according to \( e^{-\Delta/2} \), where
\begin{equation}
    \Delta/2 = \int_{x_0}^{x_e} \sqrt{2m\lvert V(x') - E \rvert}\,dx'.
\end{equation}

\subsubsection*{(a) Question}
Find an expression for \( \Delta \) by evaluating this integral. It will be convenient to use the ratio \( \rho = x_0/x_e \). Try to simplify as much as you can. Note that you may find the discussion in the text on pages 444-445 helpful.
\subsubsection{Answer}
After emitting the \( \alpha \) particle, the daughter nucleus has a charge of \( Z_1 - 2 \). Thus, we have:
\begin{equation}
    V(x) = \frac{(Z_1 - 2)Z_2e^2}{4\pi \epsilon_0 x}
\end{equation}
where \( Z_1 = 92 \) and \( Z_2 = 2 \). Thus, we have:
\begin{equation}
    V(x) = \frac{180e^2}{4\pi \epsilon_0 x}
\end{equation}
Let's define:
\begin{equation}
    \beta = \frac{180e^2}{4\pi \epsilon_0}
\end{equation}
So:
\begin{equation}
    V(x) = \frac{\beta}{x}
\end{equation}
And we have at the classical turning point:
\begin{equation}
    V(x_e) = E
\end{equation}
So, we have:
\begin{align}
    \frac{\beta}{x_e} &= E \\
    x_e &= \frac{\beta}{E}
\end{align}
So, we want to integrate:
\begin{equation}
    \Delta/2 = \int_{x_0}^{x_e} \sqrt{2m\lvert \frac{\beta}{x'} - E \rvert}\,dx'
\end{equation}
We want to consider the integral:
\begin{equation}
    I = \sqrt{2m\beta }\int_{x_0}^{x_e}\sqrt{\frac{1}{x'}-\frac{1}{x_e}}\,dx'
\end{equation}
We can make the substitution:
\begin{equation}
    z=\frac{x}{x_e} \implies x = x_e z \implies dx = x_e dz
\end{equation}
So, we have:
\begin{equation}
    I = \sqrt{2m\beta x_e}\int_{x_0/x_e}^{1}\sqrt{\frac{1}{z}-1}\,dz
\end{equation}
Calling $x_0/x_e = \rho$, we have:
\begin{equation}
    I = \sqrt{2m\beta x_e}\int_{\rho}^{1}\sqrt{\frac{1}{z}-1}\,dz
\end{equation}
We can format the integral as:
\begin{equation}
    I_0 = \int_{\rho }^{1}\sqrt{\frac{1-z}{z}} dz
\end{equation}
We make the substitution $z = \cos^2(\theta)$, so that $dz = -2\cos(\theta)\sin(\theta)d\theta$. Thus, we have:
\begin{equation}
    I_0 = -2\int_{\theta _0}^{0}\frac{\sin(\theta )}{\cos(\theta )}\times \cos(\theta )\sin(\theta )d\theta = 2\int_{0}^{\theta _0}\sin^2(\theta )d\theta = \eval{\omega - \sin(\omega)\cos(\omega)}_0^{\theta _0} = \theta _0 - \sin(\theta _0)\cos(\theta _0)
\end{equation}
We know that:
\begin{equation}
    \theta _0 = \cos^{-1}(\sqrt{\rho } )
\end{equation}
so:
\begin{equation}
    \frac{\Delta  }{2} = \sqrt{2m\beta x_e}\left(\cos^{-1}(\sqrt{\rho })-\sqrt{\rho }\sqrt{1-\rho }\right)
\end{equation}
with the relationships for $\beta $ and $x_e$ defined above.

\subsubsection*{(b) Question}
Find an expression for \( x_e \) in terms of known quantities.

\subsubsection*{(b) Answer}
\begin{equation}
    x_e = \frac{\beta}{E} = \frac{180e^2}{4\pi \epsilon_0 E}
\end{equation}
For the energy, we have:
\begin{equation}
    E = 4.267 MeV
\end{equation}
The attached script gives $x_e = 60.74 fm$.
% Inline Python code in the document
\begin{lstlisting}[language=Python]
import sympy as sp

def calculate_xe(E_MeV):
    # Define the symbols
    e = sp.symbols('e')  # elementary charge
    epsilon_0 = sp.symbols('epsilon_0')  # vacuum permittivity
    E = sp.symbols('E')  # energy in Joules

    # Define the expression for x_e
    x_e_expr = 180 * e**2 / (4 * sp.pi * epsilon_0 * E)

    # Constants
    e_value = 1.602e-19  # elementary charge in Coulombs
    epsilon_0_value = 8.854e-12  # vacuum permittivity in C^2/N.m^2
    E_Joules = E_MeV * 1.602e-13  # Convert energy from MeV to Joules

    # Substitute constants and calculate x_e
    x_e = x_e_expr.subs({e: e_value, epsilon_0: epsilon_0_value, E: E_Joules})

    # Convert x_e to femtometers (1 fm = 1e-15 m)
    return x_e / 1e-15

def main():
    # User input for the energy in MeV
    E_MeV = float(input("Enter the energy in MeV: "))

    # Calculate and display x_e
    x_e_fm = calculate_xe(E_MeV)
    print(f"The value of x_e is approximately {x_e_fm.evalf():.2f} fm")

if __name__ == "__main__":
    main()

\end{lstlisting}

\subsubsection*{(c) Question}
To estimate the decay rate, we must multiply the tunneling probability by the rate at which the \( \alpha \) strikes the potential barrier at \( x_0 \). For this rate to strike the barrier by estimating the speed of the \( \alpha \) particle and the distance traveled between collisions.

\subsubsection*{(c) Answer}
Following Shankar:
We have found the exponential function that damps the wave function. The ratio of the wave function at $x_0$ versus $x_e$ is:
\begin{equation}
    \abs{\frac{\psi (x_e)}{\psi (x_0)}}^2 \approx \abs{e^{-\Delta /2}}^2 = e^{-\Delta }
\end{equation}
Next we want to find the frequency at which the particle slams into the barrier:
\begin{equation}
    f = \frac{v}{2x_0}
\end{equation}
for the velocity, we have $v = \sqrt{2E/m}$ and twice the length of the box is $2x_0$, so:
\begin{equation}
    f = \frac{\sqrt{2E/m}}{2x_0}
\end{equation}
Combining these two results, the decay wait $R$ is:
\begin{equation}
    R = \frac{\sqrt{2E/m}}{2x_0}e^{-\Delta }
\end{equation}


\subsubsection*{(d) Question}
Finally, put it all together and obtain a numerical prediction for the uranium decay rate. Compare your result with the observed decay rate.

\subsubsection*{(d) Answer}
I am catting a decay wait of 7.17336680189066E+20 $s^{-1}$, which is a half life of something on the order of $10^{-21}s$, so I am not really sure what is going on here. The experimental value for the half life is on the order of $10^{17}s$.
% Inline Python code in the document
\begin{lstlisting}[language=Python]
import sympy as sp

# Define the symbols
m, E, x_0, e, epsilon_0 = sp.symbols('m E x_0 e epsilon_0')

# Constants
E_value = 4.267  # Energy in MeV
E_Joules = E_value * 1.602e-13  # Convert energy from MeV to Joules
e_value = 1.602e-19  # elementary charge in Coulombs
epsilon_0_value = 8.854e-12  # vacuum permittivity in C^2/Nm^2
m_value = 4 * 1.66053904e-27  # Mass of alpha particle (4 times the mass of a proton)
x_e_value = 60.74e-15  # x_e value in meters

# Calculation of beta
beta_expr = 180 * e**2 / (4 * sp.pi * epsilon_0)
beta_value = beta_expr.subs({e: e_value, epsilon_0: epsilon_0_value})

# Calculation for Delta
rho = x_0 / x_e_value
theta_0 = sp.acos(sp.sqrt(rho))
delta_expr = sp.sqrt(2 * m * beta_expr * x_e_value) * (theta_0 - sp.sqrt(rho) * sp.sqrt(1 - rho))
delta_value = delta_expr.subs({m: m_value, e: e_value, epsilon_0: epsilon_0_value, x_0: rho * x_e_value})

# Calculation of Decay Rate R
v_expr = sp.sqrt(2 * E / m)  # Velocity of alpha particle
f_expr = v_expr / (2 * x_0)  # Frequency of striking the barrier
R_expr = f_expr * sp.exp(-delta_value)  # Decay rate

# Function to calculate decay rate and half-life
def calculate_decay_rate_and_half_life(x_0_value):
    decay_rate = R_expr.subs({x_0: x_0_value, m: m_value, E: E_Joules}).evalf()
    half_life = sp.log(2) / decay_rate  # Half-life calculation
    return decay_rate, half_life

# Example usage
x_0_example = 10e-15  # Example value for x_0 in meters
hbar = 1.0545718e-34  # Reduced Planck constant
decay_rate, half_life = calculate_decay_rate_and_half_life(x_0_example)
print(f"The estimated decay rate is {decay_rate} s^-1")
print(f"The estimated half-life is {half_life} s")

\end{lstlisting}

\subsection*{Problem 7}
Let's do a very simple calculation using the Ritz method, in order to make sure we understand the idea. Suppose we are interested in the energy levels of a particle of mass \( m \) in the one dimensional potential:
\begin{equation}
    V(x) = \begin{cases}
    0 & x \in (-L/2, L/2) \\
    \infty & \text{otherwise}
    \end{cases}
\end{equation}
Of course, we know the exact answer to both the eigenstates and eigenvalues for this system. However, let us pretend that we don't, and try using the Ritz method to estimate the two lowest energy levels. Thus, let us pick two trial wave functions. We might by accident in this simple case actually pick the exact functions, but we'll avoid that. Let us make an ``educated guess'', and choose:
\begin{align}
    |1\rangle &= A_1 \left[ (L/2)^2 - x^2 \right] \\
    |2\rangle &= A_2 x \left[ (L/2)^2 - x^2 \right],
\end{align}
where \( A_1 \) and \( A_2 \) are normalization constants and it is understood that these functions are taken to be zero when \( |x| \geq L/2 \). I encourage you to consider why this might be a good guess, even if we avoided the exact answers.

\subsubsection*{(a) Question}
Carry out the Ritz procedure using these two trial wave functions, and estimate the two lowest energy levels. Along the way, try to note how we really did make some good choices.

\subsubsection*{(a) Answer}
Our expansion looks like the following:
\begin{equation}
    \ket{\psi} = c_1\ket{1} + c_2\ket{2}
\end{equation}
where
\begin{equation}
    |c_1|^2 + |c_2|^2 = 1
\end{equation}
We first set out to normalize our trial wave functions:
\begin{align}
    \braket{1}{1} = 1 &= \int_{-L/2}^{L/2} A_1^2 \left[ (L/2)^2 - x^2 \right]^2 dx \\
\end{align}
My attached script in Sympy gives:
\begin{equation}
\boxed{A_1 = \left(\frac{30}{L^5}\right)^{1/2}}
\end{equation}
Next, we normalize the other one:
\begin{align}
    \braket{2}{2} = 1 &= \int_{-L/2}^{L/2} A_2^2 x^2 \left[ (L/2)^2 - x^2 \right]^2 dx \\
\end{align}
My attached script in Sympy gives:
\begin{equation}
\boxed{A_2 = 2\left(\frac{210}{L^7}\right)^{1/2}}
\end{equation}
Now come we want to evaluate the functional for the energy:
\begin{equation}
    E(c_1, c_2) = \bra{\psi}H\ket{\psi} = c_1^*c_1\bra{1}H\ket{1} + c_2^*c_2\bra{2}H\ket{2} + c_1^*c_2\bra{1}H\ket{2} + c_2^*c_1\bra{2}H\ket{1}
\end{equation}
with the Hamiltonian:
\begin{equation}
    H = -\frac{\hbar^2}{2m}\frac{d^2}{dx^2}
\end{equation}
Now, we evaluate the matrix elements:
\begin{align}
    \bra{1}H\ket{1} &= \int_{-L/2}^{L/2} A_1^2 \left[ (L/2)^2 - x^2 \right] \left(-\frac{\hbar^2}{2m}\frac{d^2}{dx^2}\right) \left[ (L/2)^2 - x^2 \right] dx \\ &= \frac{A_1^2L^3\hbar^2}{6m}
\end{align}
\begin{align}
    \bra{2}H\ket{2} &= \int_{-L/2}^{L/2} A_2^2 x^2 \left[ (L/2)^2 - x^2 \right] \left(-\frac{\hbar^2}{2m}\frac{d^2}{dx^2}\right) \left[ (L/2)^2 - x^2 \right] dx \\ &= \frac{A_2^2L^5\hbar^2}{40m}
\end{align}
The cross terms are zero, since the integrand is odd. Thus, we have a Hamiltonian matrix in a basis of $\ket{1}$ and $\ket{2}$:
\begin{equation}
    \begin{bmatrix}
    \frac{A_1^2L^3\hbar^2}{6m} & 0 \\
    0 & \frac{A_2^2L^5\hbar^2}{40m}
    \end{bmatrix}
\end{equation}
Our gas was good since this matrix is diagonal. Now we follow the Rayleigh-Ritz procedure:
\begin{equation}
    \begin{bmatrix}
    \frac{A_1^2L^3\hbar^2}{6m} & 0 \\
    0 & \frac{A_2^2L^5\hbar^2}{40m}
    \end{bmatrix}
    \begin{bmatrix}
    c_1 \\
    c_2
    \end{bmatrix}
    = E
    \begin{bmatrix}
    c_1 \\
    c_2
    \end{bmatrix}
\end{equation}
Since the matrix is already diagonal, we can just read off the eigenvalues:
\begin{align}
    E_1 &= \frac{A_1^2L^3\hbar^2}{6m} \\
    E_2 &= \frac{A_2^2L^5\hbar^2}{40m}
\end{align}
Plugging in our values for $A_1$ and $A_2$, we have:
\begin{align}
    E_1 &= \frac{5\hbar^2}{mL^2} \\
    E_2 &= \frac{21\hbar^2}{mL^2}
\end{align}
\begin{algorithm}[H]
\SetAlgoLined
\KwResult{Integral evaluation}
\begin{verbatim}
    import sympy as sp
# Define the symbols
x, L, A1, A2, hbar, m = sp.symbols('x L A1 A2 hbar m')
# first normalization constant
fn1 = A1 * ((L/2)**2 - x**2)
first_integral = sp.integrate(fn1**2, (x, -L/2, L/2))
first_equation = sp.Eq(first_integral, 1)
first_A1 = sp.solve(first_equation, A1)
# second normalization constant
fn2 = A2 * x * ((L/2)**2 - x**2)
second_integral = sp.integrate(fn2**2, (x, -L/2, L/2))
second_equation = sp.Eq(second_integral, 1)
second_A2 = sp.solve(second_equation, A2)
# lope over all of the possibilities
for bra in [1, 2]:
    for ket in [1, 2]:
        # define the wave function
        if bra == 1:
            bra_function = fn1
        elif bra == 2:
            bra_function = fn2
        if ket == 1:
            ket_function = fn1
        elif ket == 2:
            ket_function = fn2
        # Define the Hamiltonian operator part: -hbar^2 / (2m) * d^2/dx^2
        Hamiltonian_operator = (-hbar**2 / (2*m)) * sp.diff(ket_function, x, 2)

        # Calculate the integral
        integral_result_Hamiltonian = sp.integrate(bra_function * Hamiltonian_operator, (x, -L/2, L/2))
        integral_result_Hamiltonian.simplify()
        # Print the result
        print('bra = {}, ket = {}:'.format(bra, ket))
        print(integral_result_Hamiltonian)
\end{verbatim}
\caption{Code for evaluating the integrals}
\end{algorithm}

\subsubsection*{(b) Question}
Compare your results with the exact eigenvalues for the two lowest levels.

\subsubsection*{(b) Answer}
The exact energies of the particle in a box are given by:
\begin{equation}
    E_n = \frac{n^2\pi^2\hbar^2}{2mL^2}
\end{equation}
Thus, we have:
\begin{equation}
    \frac{E_1^{our}}{E_1^{exact}} = \frac{10}{\pi^2} \approx 1.01
\end{equation}
and:
\begin{equation}
    \frac{E_2^{our}}{E_2^{exact}} = \frac{42}{\pi^2} \approx 1.06
\end{equation}

\subsection*{Problem 8}
Consider an ``anharmonic'' oscillator, in which we add a perturbation
\begin{equation}
    V = -\rho \omega \hat{X}^3.
\end{equation}
to the one-dimension harmonic oscillator Hamiltonian. Here, we define $ \hat{X} = \sqrt{m\omega}X$. The unperturbed Hamiltonian is
\begin{equation}
    H_0 = \frac{P^2}{2m} + \frac{m\omega^2 X^2}{2}.
\end{equation}
The parameter \( 0 < \rho \ll 1 \) is a small dimensionless parameter giving the strength of the perturbation. [We assume that the perturbation is sufficiently small that we needn't worry about what happens at very large values of \( x \).]

\subsubsection*{(a) Question}
Write the perturbation in terms of the raising and lowering operators \( a \) and \( a^\dagger \). Compute all of the non-zero matrix elements of \( V \) in the basis of the unperturbed eigenstates.

\subsubsection*{(a) Answer}
First, we note that:
\begin{equation}
    X = \sqrt{\frac{\hbar}{2m\omega}}(a + a^\dagger).
\end{equation}
so that:
\begin{equation}
    \hat{X} = \sqrt{\frac{\hbar}{2}}(a + a^\dagger).
\end{equation}
Then, we have:
\begin{align}
    V &= -\rho \omega \hat{X}^3 \\
    &= -\rho \omega \left( \sqrt{\frac{\hbar}{2}}(a + a^\dagger) \right)^3 \\
    &= -\rho \omega \left( \sqrt{\frac{\hbar}{2}} \right)^3 (a + a^\dagger)^3 \\
    &= -\rho \omega \left( \sqrt{\frac{\hbar}{2}} \right)^3 (a^2 + a^\dagger a + aa^\dagger + a^{\dagger 2}) (a + a^\dagger) \\
    &= -\rho \omega \left( \sqrt{\frac{\hbar}{2}} \right)^3 (a^3 + a^2a^\dagger + a^{\dagger}a^2 + a^{\dagger}aa^{\dagger} + aa^{\dagger}a + aa^{\dagger 2} + a^{\dagger 2}a + a^{\dagger 3}) \\
\end{align}
% \emph{I want to briefly talk about this}\\
% Since we have the relations:
% \begin{align}
%     [a, a^\dagger] = 1 \\
%     [a, a] = 0 \\
%     [a^\dagger, a^\dagger] = 0
% \end{align}
% We can simplify:
% \begin{align}
%     V &= -\rho \omega \left( \sqrt{\frac{\hbar}{2}} \right)^3 (a^3 + a^2a^\dagger + a^2a^{\dag} - a^{\dag 2}a - a^2a^{\dagger } + a^{\dagger 2}a + a^{\dag 2}a + a^{\dagger 3}) \\
%     &= -\rho \omega \left( \sqrt{\frac{\hbar}{2}} \right)^3 (a^3 + a^2a^\dagger + a^{\dagger 2}a + a^{\dagger 3}) \\
% \end{align}
We define:
\begin{equation}
    V' = a^3 + a^2a^\dagger + a^{\dagger}a^2 + a^{\dagger}aa^{\dagger} + aa^{\dagger}a + aa^{\dagger 2} + a^{\dagger 2}a + a^{\dagger 3}
\end{equation}
We know that the action of:
\begin{equation}
    a\ket{n} = \sqrt{n}\ket{n-1}
\end{equation}
and
\begin{equation}
    a^\dagger\ket{n} = \sqrt{n+1}\ket{n+1}
\end{equation}
In the basis of unperturbed eigenstates, only the $\ket{n+3}$, $\ket{n+1}$, $\ket{n-1}$, and $\ket{n-3}$ states have non-zero matrix elements. Thus, following this order, we have:
\begin{align}
    \bra{n}V'\ket{n+3} = \bra{n}a^3\ket{n+3} = \sqrt{(n+3)(n+2)(n+1)} \\ \implies \boxed{\bra{n}V\ket{n+3} = -\rho \omega \left(\frac{\hbar}{2}\right)^{3/2} \sqrt{(n+3)(n+2)(n+1)}} \\
\end{align}
Next, we have:
\begin{align}
    \bra{n}V'\ket{n+1} = \bra{n}a^2a^\dagger+a^{\dagger}a^2+aa^{\dagger}a\ket{n+1} = \sqrt{(n+1)(n+2)^2} + \sqrt{(n+1)^2n} + \sqrt{(n+1)^3}\\
    \implies \boxed{\bra{n}V\ket{n+1} = -\rho \omega \left(\frac{\hbar}{2}\right)^{3/2} \left( \sqrt{(n+1)(n+2)^2} + \sqrt{(n+1)^2n} + \sqrt{(n+1)^3} \right)} \\
\end{align}
Next, we have:
\begin{align}
    \bra{n}V'\ket{n-1} = \bra{n}a^{\dagger}aa^{\dagger}+aa^{\dagger 2}+a^{\dagger 2}a\ket{n-1} = \sqrt{n^3} + \sqrt{n(n+1)^2} + \sqrt{n(n-1)^2}\\ 
    \implies \boxed{\bra{n}V\ket{n-1} = -\rho \omega \left(\frac{\hbar}{2}\right)^{3/2} \left( \sqrt{n^3} + \sqrt{n(n+1)^2} + \sqrt{n(n-1)^2} \right)} \\
\end{align}
Finally, we have:
\begin{align}
    \bra{n}V'\ket{n-3} = \bra{n}a^{\dagger 3}\ket{n-3} = \sqrt{n(n-1)(n-2)} \\ \implies \boxed{\bra{n}V\ket{n-3} = -\rho \omega \left(\frac{\hbar}{2}\right)^{3/2} \sqrt{n(n-1)(n-2)}} \\
\end{align}
\subsubsection*{(b) Question}
Compute the perturbed energy levels to the lowest non-trivial order in the perturbation.

\subsubsection*{(b) Answer}
The first order energy convection would indeed be trivial, as $E^{(1)} = \bra{n}V\ket{n} = 0$. Thus, we must compute the second order energy correction:
\begin{align}
    E^{(2)}_n &= \sum_{m \neq n} \frac{\lvert \bra{m}V\ket{n} \rvert^2}{E_n^{(0)} - E_m^{(0)}} \\
    &= \frac{\lvert \bra{n+3}V\ket{n} \rvert^2}{E_n^{(0)} - E_{n+3}^{(0)}} + \frac{\lvert \bra{n+1}V\ket{n} \rvert^2}{E_n^{(0)} - E_{n+1}^{(0)}} + \frac{\lvert \bra{n-1}V\ket{n} \rvert^2}{E_n^{(0)} - E_{n-1}^{(0)}} + \frac{\lvert \bra{n-3}V\ket{n} \rvert^2}{E_n^{(0)} - E_{n-3}^{(0)}} \\
    &= \frac{\rho^2 \omega^2 \hbar^3}{8} (\frac{(n+3)(n+2)(n+1)}{E_n^{(0)} - E_{n+3}^{(0)}} + \frac{{(n+1)(n+2)^2} + {(n+1)^2n} + {(n+1)^3}}{E_n^{(0)} - E_{n+1}^{(0)}} \\
&+ \frac{{n^3} + {n(n+1)^2} + {n(n-1)^2}}{E_n^{(0)} - E_{n-1}^{(0)}} + \frac{n(n-1)(n-2)}{E_n^{(0)} - E_{n-3}^{(0)}} ) \\
\end{align}
We know that:
\begin{equation}
    E_n^{(0)} = \hbar \omega \left( n + \frac{1}{2} \right)
\end{equation}
Thus, we have:
\begin{align}
    E^{(2)}_n &= \frac{\rho^2 \omega^2 \hbar^3}{8} (\frac{(n+3)(n+2)(n+1)}{\hbar \omega \left( n + \frac{1}{2} \right) - \hbar \omega \left( n + \frac{7}{2} \right)} + \frac{{(n+1)(n+2)^2} + {(n+1)^2n} + {(n+1)^3}}{\hbar \omega \left( n + \frac{1}{2} \right) - \hbar \omega \left( n + \frac{3}{2} \right)} \\
&+ \frac{{n^3} + {n(n+1)^2} + {n(n-1)^2}}{\hbar \omega \left( n + \frac{1}{2} \right) - \hbar \omega \left( n - \frac{1}{2} \right)} + \frac{n(n-1)(n-2)}{\hbar \omega \left( n + \frac{1}{2} \right) - \hbar \omega \left( n - \frac{5}{2} \right)} ) \\
&= \frac{\rho^2 \omega^2 \hbar^3}{8} (\frac{(n+3)(n+2)(n+1)}{-3\hbar\omega } + \frac{{(n+1)(n+2)^2} + {(n+1)^2n} + {(n+1)^3}}{-\hbar\omega } \\
&+ \frac{{n^3} + {n(n+1)^2} + {n(n-1)^2}}{\hbar\omega } + \frac{n(n-1)(n-2)}{3\hbar\omega } ) \\
&= -\frac{\rho ^2 \omega \hbar^2}{8}  (\frac{1}{3} (n+3)(n+2)(n+1) + (n+1)(n+2)^2 + (n+1)^2n\\
&+ (n+1)^3 + n^3 + n(n+1)^2 + n(n-1)^2 + \frac{1}{3} n(n-1)(n-2))  \\
\end{align}
\subsubsection*{(c) Question}
Compute the perturbed energy eigenfunctions to the lowest non-trivial order in the perturbation. Express in terms of the unperturbed energy eigenfunctions.

\subsubsection*{(c) Answer}
We have:
\begin{equation}
    \ket{N}= \ket{n} - \sum_{m \neq n} \frac{\bra{m}V\ket{n}}{E_n - E_m} \ket{m}
\end{equation}
We expand equation 38 with the elements of the summation that survive:
\begin{align}
    \ket{N} &= \ket{n} - \frac{\bra{n+3}V\ket{n}}{E_n - E_{n+3}} \ket{n+3} - \frac{\bra{n+1}V\ket{n}}{E_n - E_{n+1}} \ket{n+1} - \frac{\bra{n-1}V\ket{n}}{E_n - E_{n-1}} \ket{n-1} - \frac{\bra{n-3}V\ket{n}}{E_n - E_{n-3}} \ket{n-3} \\
\end{align}
This involves all terms that I used above, so I will not perform the tedious simplification here. That is, I solved for all the matrix aliments of $V$ in the basis of $\ket{n}$, $\ket{n+1}$, $\ket{n-1}$, and $\ket{n-3}$, and plugged them into the above equation. The values of the $E_n$ are also known. 



\end{document}
