/groups/wag/pkozlows/miniconda3/envs/pyscf/lib/python3.11/site-packages/pyscf/dft/libxc.py:772: UserWarning: Since PySCF-2.3, B3LYP (and B3P86) are changed to the VWN-RPA variant, the same to the B3LYP functional in Gaussian and ORCA (issue 1480). To restore the VWN5 definition, you can put the setting "B3LYP_WITH_VWN5 = True" in pyscf_conf.py
  warnings.warn('Since PySCF-2.3, B3LYP (and B3P86) are changed to the VWN-RPA variant, '
/central/home/pkozlows/ch121b/gan/dft/szv/111/4/s1p.py:14: UserWarning: Use ase.build.bulk() instead
  ase_cell = bulk('GaN', 'wurtzite', a=3.19, c=5.19)
Discarded 6 diffused primitive functions, 0 contracted functions


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS-KohnShamDFT
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /central/home/pkozlows/ch121b/gan/dft/szv/111/4/s1p.chk
max_memory 346706 MB (current use 118 MB)


******** PBC SCF flags ********
N kpts = 1
kpts = [[0. 0. 0.]]
Exchange divergence treatment (exxdiv) = ewald
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    madelung (= occupied orbital energy shift) = 0.3725829728992387
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -6.70649351219
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x7f39de11ccd0>
XC functionals = b3pw91
small_rho_cutoff = 1e-07
Uniform grid, mesh = [ 83  83 133]
<class 'pyscf.pbc.dft.krks.KRKS'> does not have attributes  nlc nlcgrids
Set gradient conv threshold to 0.000316228
Big error detected in the electron number of initial guess density matrix (Ne/cell = 36.0958)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 36.0
    CPU time for setting up grids      5.60 sec, wall time      0.56 sec
nelec by numeric integration = 35.999999997603695
    CPU time for vxc     61.91 sec, wall time      3.89 sec
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    CPU time for vj and vk    270.05 sec, wall time     21.13 sec
Ewald components = 6.77773183084737, -128.779455527716, 5.42224205397643
E1 = -88.22425101323412  Ecoul = 61.060991406297546  Exc = -24.98775766815212
init E= -168.730498917981
cond(S) = [7.39940068]
    CPU time for initialize scf    397.28 sec, wall time     29.98 sec
HOMO = 0.248497365063  LUMO = 0.602182790071
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.45980268 -0.37891711 -0.1121286  -0.11172501 -0.11172501 -0.10650459
 -0.10650459 -0.08711158 -0.08711158 -0.08255554 -0.08255554 -0.0691535
 -0.01153989  0.21405011  0.21405011  0.24549055  0.24849737  0.24849737] [0.60218279 0.64857194 0.83034196 0.83034196 0.83655484 0.87798427
 0.87798427 0.89683545]
nelec by numeric integration = 35.99999999854158
    CPU time for vxc     60.70 sec, wall time      3.81 sec
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    CPU time for vj and vk    224.40 sec, wall time     17.34 sec
Ewald components = 6.77773183084737, -128.779455527716, 5.42224205397643
E1 = -87.80168662527682  Ecoul = 62.872242133475844  Exc = -26.158001263123214
cycle= 1 E= -167.666927397816  delta_E= 1.06  |g|= 1.07  |ddm|= 4.28
    CPU time for cycle= 1    285.26 sec, wall time     21.16 sec
HOMO = 0.644407938013  LUMO = 0.829748990825
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.30634537 -0.30634537 -0.30574423 -0.30574423 -0.30494008 -0.3018074
 -0.29976464 -0.29976464 -0.29643616 -0.29643616 -0.12854736  0.03496809
  0.14568634  0.51828561  0.51828561  0.6419863   0.64440794  0.64440794] [0.82974899 0.8418884  0.8418884  0.86654874 0.89536306 1.01219697
 1.01219697 1.30099289]
nelec by numeric integration = 35.999999998927215
    CPU time for vxc     61.17 sec, wall time      3.84 sec
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    CPU time for vj and vk    220.91 sec, wall time     16.81 sec
Ewald components = 6.77773183084737, -128.779455527716, 5.42224205397643
E1 = -87.484298234198  Ecoul = 61.63794165779424  Exc = -24.85424244031101
cycle= 2 E= -167.280080659607  delta_E= 0.387  |g|= 1.59  |ddm|=  4.2
    CPU time for cycle= 2    282.27 sec, wall time     20.66 sec
HOMO = 0.465411484759  LUMO = 0.749575327017
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.22149834 -0.21929306 -0.2045202  -0.2045202  -0.20301752 -0.20301752
 -0.20114602 -0.19513871 -0.19513871 -0.19102204 -0.19102204 -0.07564965
  0.10043346  0.38549649  0.38549649  0.45769884  0.45769884  0.46541148] [0.74957533 0.76354321 0.82475606 0.82475606 0.84918422 0.92916682
 0.92916682 1.1103039 ]
nelec by numeric integration = 35.9999999986539
    CPU time for vxc     61.69 sec, wall time      3.88 sec
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    CPU time for vj and vk    225.23 sec, wall time     17.09 sec
Ewald components = 6.77773183084737, -128.779455527716, 5.42224205397643
E1 = -87.81994481153352  Ecoul = 61.731262913287466  Exc = -25.50756830646111
cycle= 3 E= -168.175731847599  delta_E= -0.896  |g|= 0.0115  |ddm|= 2.45
    CPU time for cycle= 3    287.46 sec, wall time     21.00 sec
HOMO = 0.45578821221  LUMO = 0.745174746513
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.22698994 -0.22655076 -0.21039557 -0.21039557 -0.2089414  -0.2089414
 -0.20634439 -0.2006668  -0.2006668  -0.196398   -0.196398   -0.08238752
  0.09398081  0.3741016   0.3741016   0.44600441  0.44600441  0.45578821] [0.74517475 0.75896775 0.82262974 0.82262974 0.84707125 0.92621975
 0.92621975 1.10322838]
nelec by numeric integration = 35.99999999865306
    CPU time for vxc     61.06 sec, wall time      3.84 sec
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    CPU time for vj and vk    222.68 sec, wall time     16.92 sec
Ewald components = 6.77773183084737, -128.779455527716, 5.42224205397643
E1 = -87.81097923087043  Ecoul = 61.719004338094315  Exc = -25.504354170593686
cycle= 4 E= -168.175810706262  delta_E= -7.89e-05  |g|= 0.00251  |ddm|= 0.0294
    CPU time for cycle= 4    283.89 sec, wall time     20.76 sec
HOMO = 0.456289257886  LUMO = 0.745420674364
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.22728592 -0.22622955 -0.21087035 -0.21087035 -0.20941944 -0.20941944
 -0.20681329 -0.20116531 -0.20116531 -0.196903   -0.196903   -0.08210565
  0.09407157  0.37463011  0.37463011  0.44663668  0.44663668  0.45628926] [0.74542067 0.75920461 0.82255248 0.82255248 0.84704959 0.92627692
 0.92627692 1.10356563]
nelec by numeric integration = 35.999999998653266
    CPU time for vxc     60.94 sec, wall time      3.84 sec
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    CPU time for vj and vk    223.91 sec, wall time     16.78 sec
Ewald components = 6.77773183084737, -128.779455527716, 5.42224205397643
E1 = -87.81065727459413  Ecoul = 61.7177822065541  Exc = -25.503456504202973
cycle= 5 E= -168.175813215135  delta_E= -2.51e-06  |g|= 0.000368  |ddm|= 0.00403
    CPU time for cycle= 5    285.00 sec, wall time     20.62 sec
HOMO = 0.456387847073  LUMO = 0.745447698712
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.2272918  -0.22616911 -0.21089128 -0.21089128 -0.20944019 -0.20944019
 -0.20684517 -0.20119295 -0.20119295 -0.19693128 -0.19693128 -0.08205358
  0.09410598  0.3747176   0.3747176   0.44674194  0.44674194  0.45638785] [0.7454477  0.75925675 0.82255472 0.82255472 0.8470464  0.92629951
 0.92629951 1.10364271]
nelec by numeric integration = 35.999999998653266
    CPU time for vxc     61.58 sec, wall time      3.87 sec
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    CPU time for vj and vk    223.30 sec, wall time     16.93 sec
Ewald components = 6.77773183084737, -128.779455527716, 5.42224205397643
E1 = -87.81064835200655  Ecoul = 61.71761918606758  Exc = -25.503302459701437
cycle= 6 E= -168.175813268532  delta_E= -5.34e-08  |g|= 1.27e-05  |ddm|= 0.000639
    CPU time for cycle= 6    285.05 sec, wall time     20.81 sec
HOMO = 0.456388304164  LUMO = 0.745448314429
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.22728817 -0.22616926 -0.21088676 -0.21088676 -0.20943573 -0.20943573
 -0.20683986 -0.20118763 -0.20118763 -0.19692589 -0.19692589 -0.08205192
  0.09410676  0.3747179   0.3747179   0.44674215  0.44674215  0.4563883 ] [0.74544831 0.75925782 0.82255482 0.82255482 0.84704752 0.92629957
 0.92629957 1.10364386]
nelec by numeric integration = 35.999999998653266
    CPU time for vxc     60.67 sec, wall time      3.81 sec
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    CPU time for vj and vk    223.89 sec, wall time     16.79 sec
Ewald components = 6.77773183084737, -128.779455527716, 5.42224205397643
E1 = -87.81065244505938  Ecoul = 61.7176213180273  Exc = -25.50330049869374
Extra cycle  E= -168.175813268618  delta_E= -8.54e-11  |g|= 5.51e-06  |ddm|= 4.47e-05
    CPU time for scf_cycle   2390.93 sec, wall time    175.61 sec
    CPU time for SCF   2390.93 sec, wall time    175.61 sec
converged SCF energy = -168.175813268618
nelec by numeric integration = 35.999999998653266
    CPU time for vxc    510.59 sec, wall time     32.08 sec
Ewald components = 0.00051775335925431, -0.251419253935776, 0.0646100141269025
    CPU time for vj and vk   6468.33 sec, wall time    673.58 sec

WARN: 2.03 error found in overlap integrals. cell.precision  or  cell.rcut  can be adjusted to improve accuracy.

Traceback (most recent call last):
  File "/central/home/pkozlows/ch121b/gan/dft/szv/111/4/s1p.py", line 49, in <module>
    e_kn_2 = kmf.get_bands(k_points)[0]
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/groups/wag/pkozlows/miniconda3/envs/pyscf/lib/python3.11/site-packages/pyscf/pbc/scf/khf.py", line 691, in get_bands
    mo_energy, mo_coeff = self.eig(fock, s1e)
                          ^^^^^^^^^^^^^^^^^^^
  File "/groups/wag/pkozlows/miniconda3/envs/pyscf/lib/python3.11/site-packages/pyscf/pbc/scf/khf.py", line 654, in eig
    e, c = self._eigh(h_kpts[k], s_kpts[k])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/groups/wag/pkozlows/miniconda3/envs/pyscf/lib/python3.11/site-packages/pyscf/scf/hf.py", line 1537, in _eigh
    return eig(h, s)
           ^^^^^^^^^
  File "/groups/wag/pkozlows/miniconda3/envs/pyscf/lib/python3.11/site-packages/pyscf/scf/hf.py", line 1183, in eig
    e, c = scipy.linalg.eigh(h, s)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/groups/wag/pkozlows/miniconda3/envs/pyscf/lib/python3.11/site-packages/scipy/linalg/_decomp.py", line 593, in eigh
    raise LinAlgError('The leading minor of order {} of B is not '
numpy.linalg.LinAlgError: The leading minor of order 9 of B is not positive definite. The factorization of B could not be completed and no eigenvalues or eigenvectors were computed.
